<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Test</title>
  <style>
    body{
      margin:0;
      text-align: center;
    }
    .img_list{
      width:800px;
      margin:10px auto 0;
      overflow: hidden;
    }
    .img_wrapper{
      float: left;
      overflow: hidden;
      margin-top:10px;
      margin-left:10px;
      width:300px;
      position: relative;
    }
    .img_wrapper img {
      width:100%;
      height:100%;
      display: block;
      position: relative;
      z-index:0;
    }
    .img_loading_mask{
      background-color:rgba(0,0,0,.2);
      position: absolute;
      top:0;
      left:0;
      right:0;
      bottom:0;
      z-index:1;
    }
    .img_loading_percent_bg{
      position: absolute;
      bottom:0;
      left:0;
      right:0;
      background-color: rgba(0,255,0,.5);
      z-index:2;
      -webkit-transition: top 0.1s ease;
      transition: top 0.1s ease;
    }
    .img_loading_percent{
      color: #ffffff;
      font-size:20px;
      font-weight: bold;
      text-align: center;
      position: absolute;
      top:0;
      left:0;
      right:0;
      bottom:0;
      z-index:3;
    }

  </style>
</head>
<body>
<div class="main" id="main">
  <div style="width:100px;height:100px;line-height: 100px;
	margin:0 auto;border:1px solid #cccccc;position: relative;" id="test">
    upload
  </div>
  <div class="img_list" id="img_list"></div>
</div>
<script type="text/template" id="img_list">
  {{each image_list as image}}
  <div class="img_wrapper" data-name="{{image.name}}">
    <img src="{{image.url}}">
    <div class="img_loading_mask">
      <div class="img_loading_percent">0%</div>
      <div class="img_loading_percent_bg"></div>
    </div>
  </div>
  {{/each}}
</script>
<script>
  window.onerror = function() {
    document.body.innerHTML = JSON.stringify(arguments)
  }
</script>
<script type="text/javascript" src="../node_modules/jquery/dist/jquery.min.js"></script>
<script type="text/javascript" src="../node_modules/art-template/lib/template-web.js"></script>
<script type="text/javascript" src="../node_modules/exif-js/exif.js"></script>
<script type="text/javascript" src="../dist/sg.min.js"></script>
<script type="text/javascript" src="../dist/fileuploader.min.js"></script>
<script>
  sg.init({
    debug:1
  });
  sg.Component.FileUploader($('#test'), {
    title : '请选择多张图片',
    multiple : true,
    preview : true,
    autoSubmit : false,
    extension : 'image',
    maxSize : 10485760,
    onSelect : function(files) {
      if(!files.length) {
        return
      }
      var self = this
      var image_list = []
      for(var i = 0, length = files.length; i<length; i++) {
        image_list.push(files[i].url)
      }
      sg.View.require('img_list').render($('#img_list'), {
        image_list : files
      }, null, 1)
      self.clear()
    },
    onError : function(error, file) {
      console.log(error, file)
    }
  })
</script>
</body>
</html>